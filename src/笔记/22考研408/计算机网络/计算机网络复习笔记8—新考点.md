# VLAN的基本概念和原理

## 传统局域网的限制

* 缺乏流量隔离:即使把组流量局域化道一个单一交换机中，广播流量仍会跨越整个机构网络(ARP、RIP、DHCP协议)
* 管理用户不便:如果一个主机在不同组间移动，必须改变物理布线，连接到新的交换机上。
* 路由器成本较高:局域网内使用很多路由器花销较大。

## VLAN的基本概念

==虚拟局域网VLAN (Virtual Local Area Network)==是一种<font color='blue'>将局域网内的设备划分成与物理位置无关的逻辑组</font>的技术，这些逻辑组有某些共同的需求。每个VLAN是一个单独的广播域/不同的子网。

虚拟网络建立在网络交换机之上，它以==软件方式==来实现逻辑工作组的划分与管理

## VLAN的实现

### 基于接口的VLAN技术

交换机上生成的各VLAN互不相通，若想实现通信，需要借助:==路由器或三层交换机==

<img src="C:\Users\LIMBO\AppData\Roaming\Typora\typora-user-images\image-20211127145413811.png" alt="image-20211127145413811" style="zoom:80%;" />

### 基于MAC地址的VLAN技术

<img src="C:\Users\LIMBO\AppData\Roaming\Typora\typora-user-images\image-20211127145511483.png" alt="image-20211127145511483" style="zoom:80%;" />

------

## IEEE802.1Q帧

<img src="C:\Users\LIMBO\AppData\Roaming\Typora\typora-user-images\image-20211127145647450.png" alt="image-20211127145647450" style="zoom:80%;" />

<img src="C:\Users\LIMBO\AppData\Roaming\Typora\typora-user-images\image-20211127145709048.png" alt="image-20211127145709048" style="zoom:80%;" />

VLAN标记的前两个字节表明是IEEE 802.1Q帧，接下来4位没用，==后面12位是VLAN标识符VID==,唯一表示了该以太网帧属于哪个VLAN。

* VID的取值范围为0\~4095，但0和4095都不用来表示VLAN，因此用于==表示VLAN的有效VID取值范围为1~4094==。
* IEEE 802.1Q帧是由交换机来处理的，而不是由用户主机来处理的。(==即主机和交换机之间只交换普通的以太网帧==)

# SDN基本概念

路由器功能：**路由选择&转发**

转发:达到路由器输入链路之一的数据报如何转发到该路由器的输出链路之一。**时间短，通常硬件解决。**

路由选择:控制数据报沿着从源主机到目的主机的端到端路径中路由器之间的路由方式。**时间长，通常软件解决。**

------

## 数据平面

数据平面对于数据处理过程中各种具体处理转发过程。

数据平面执行的主要功能是==根据转发表进行转发==，这是路由器的本地动作。



## 控制平面

控制平面用于控制和管理网络协议的运行，比如OSPF协议、RIP协议、BGP协议。

### 传统方法（每路由器法）

路由选择算法运行在每台路由器中，并且在每台路由器中都包含转发和路由选择两种功能。

实现方法：**在一台路由器中的路由选择算法与其他路由器中的路由选择算法通信（通过交换路由选择报文)，计算出路由表和转发表。**

<img src="C:\Users\LIMBO\AppData\Roaming\Typora\typora-user-images\image-20211127152338288.png" alt="image-20211127152338288" style="zoom:80%;" />

### SDN法

**控制平面从路由器物理上分离**。路由器仅实现**转发**，远程控制器计算和分发转发表以供每台路由器所使用。

路由器通过交换包含转发表和其他路由选择信息的报文与远程控制器通信。因为计算转发并与路由器交互的控制器是用软件实现的，所以网络是“软件定义的"。

<img src="C:\Users\LIMBO\AppData\Roaming\Typora\typora-user-images\image-20211127152447744.png" alt="image-20211127152447744" style="zoom:80%;" />

## 路由选择处理机

* 传统方法:
  路由选择处理器执行控制平面功能。在传统的路由器中，它执行路由选择协议，维护路由选择表于关联链路状态信息，并为该路由器计算转发表。
* SDN方法:
  在SDN路由器中，路由选择处理器负责与远程控制器通信，目的是接收远程控制器计算的转发表项。==（地位下降）==

## SDN控制平面

1. **SDN控制器**:维护准确的网络状态信息(远程链路、交换机和主机的状态)；为运行在控制平面中的网络控制应用程序提供这些信息（逻辑集中，在多台服务器上实现)。
2. **网络控制应用程序**:根据SDN控制器提供的方法，这些应用程序通过这些方法能够监视、编程和控制下面的网络设备。

<img src="C:\Users\LIMBO\AppData\Roaming\Typora\typora-user-images\image-20211127152928662.png" alt="image-20211127152928662" style="zoom:80%;" />

### SDN控制器的三层

<img src="C:\Users\LIMBO\AppData\Roaming\Typora\typora-user-images\image-20211127153243080.png" alt="image-20211127153243080" style="zoom:80%;" />

#### 对于网络控制应用程序的接口

SDN控制器通过“北向接口”与网络控制应用程序交互。该API允许网络控制应用程序在状态管理层之间读写网络状态。

#### 网络范围状态管理层

由SDN控制平面作出的最终控制决定,将要求控制器具有有关网络的主机、链路等最新状态信息。

#### 通信层

SDN控制器与受控网络设备之间的通信(OpenFlow协议)，包含"南向接口”